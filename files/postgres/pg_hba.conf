# TYPE  DATABASE        USER            ADDRESS                 METHOD

# 1. Localhost (Unix socket & Loopback)
# PURPOSE:
#   Allows local processes inside the container (like the startup scripts or health checks)
#   to connect without a password.
#   RISK: Trusted access is acceptable here because only the container process itself
#   can access the loopback interface or the Unix socket.
local   all             all                                     trust
host    all             all             127.0.0.1/32            trust
host    all             all             ::1/128                 trust

# 2. NETWORK CONNECTIONS (POD-TO-POD & EXTERNAL)
# POLICY:
#   All external connections (from other Pods like the application or workers)
#   MUST provide a valid password.
#   METHOD: 'scram-sha-256' is the modern, secure hashing standard for Postgres,
#   replacing the older 'md5' method.
#   CONTEXT: In Kubernetes, pod IPs are dynamic (0.0.0.0/0), so we cannot restrict
#   access by IP here easily. We rely on NetworkPolicies (if implemented) and strong passwords.
host    all             all             0.0.0.0/0               scram-sha-256
host    all             all             ::/0                    scram-sha-256